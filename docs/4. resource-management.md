```{lark-callout}
:bg: light-orange
:bc: orange
:icon: copyright

版本：v3.0

贡献者：undefined

历史版本：[第 4 章 资源的玩法](https://zxdwhda-share.feishu.cn/wiki/M7towKWKhiLMxWkTCincqhDAnjc?edition_id=C7FUB2)
```

# 资源的玩法

## 资源的定义

在 Coze 平台中，插件、知识库、数据库、提示词库、音色等都属于资源的范畴。考虑到学习难度的递进，本章将重点介绍插件、知识库和提示词库（包括提示词编写和测试技巧）。

对于非技术背景的用户，本章内容具有一定的上手难度，建议先进行理论学习，再返回进行实际操作。

### 插件概述

插件是一个工具集合，一个插件内可以包含一个或多个工具（API）。目前，Coze 集成了超过 1 万个插件，涵盖图像类、文本类、搜索类、数据分析、语音识别等多个领域。这些插件为智能体提供了强大的功能扩展，用户可以根据实际需求选择不同的插件，满足各种业务场景。

例如，通过添加新闻阅读插件，可以让智能体随时为用户提供最新的资讯；在旅行规划方面，插件可以帮助用户查询航班信息、酒店价格等。当 Coze 集成的插件不满足使用需求时，用户还可以创建自定义插件来集成需要使用的 API。

### 知识库概述

Coze 提供了简单易用的知识库功能，支持智能体与用户自己的数据进行交互。用户可以在知识库中存储和管理数据，无论是处理 PDF 中的数十万字还是网站中的实时信息，只需创建一个知识库，机器人就可以访问相关知识。

知识库支持文本、表格、照片等多种数据格式，以及 TXT 文件、在线网页数据、Notion 页面、数据库、API JSON 等多种数据源。这使得智能体能够回答专业领域的问题，提高回答的准确性和可靠性。

### 提示词库概述

提示词是为大语言模型提供任务指导的自然语言指令。搭建智能体的第一步就是设置提示词，用户可以根据业务需要直接编写提示词，也可以使用提示词模板、引用提示词资源或通过 AI 自动生成提示词。

Coze 提供了丰富的提示词库和优化工具，帮助用户快速创建高质量的提示词，提升智能体的交互效果。



## 插件

### 插件的基本概念

插件是 Coze 平台的核心功能之一，它允许智能体调用外部服务和 API，扩展智能体的能力边界。每个插件都包含一个或多个工具，每个工具对应一个具体的 API 接口。使用这些插件，可以帮助我们拓展智能体能力边界。例如，我们第三章的夸夸智能体内添加搜索插件，我们的智能体将拥有搜索新闻资讯的能力。

当Coze集成的插件不满足我们的使用需求，我们还可以创建自定义插件来集成需要使用的 API，后面我会从IDE 创建插件、通过 JSON 或 YAML 文件导入插件，教大家如何扩展我们的使用边界。

#### 插件的组成结构

一个完整的插件包含以下几个部分：​

> 后面结合具体页面详细讲解

1. **元数据** 

元数据的作用是让大语言模型理解每个工具输入或输出参数的含义。因此，在工具的元数据内提供详细的参数说明，可以让大语言模型更准确地使用工具。

当用户在使用该工具的智能体时，模型会根据工具的元数据信息，从用户问答中解析、提取出对应的输入参数，并选择调用该工具。

2. **工具实现** 

工具实现包含具体的 API 调用逻辑和数据处理代码。开发者可以使用 JavaScript 或 Python 等语言编写工具的实现代码。

3. **测试配置** 

测试配置用于验证工具的功能是否正常工作。开发者可以设置测试输入参数，并查看工具的输出结果。

#### 插件的分类

根据功能和用途，Coze 的插件可以分为以下几类：​

 **资讯类插件** 

- 新闻搜索

- 天气查询

- 股票行情

- 汇率转换

 **办公类插件** 

- 文档处理

- 表格分析

- 演示文稿制作

- 邮件发送

 **创意类插件** 

- 图片生成

- 视频编辑

- 音乐创作

- 文案生成

 **数据分析类插件** 

- 数据可视化

- 统计分析

- 机器学习

- 预测模型

### 使用 IDE 创建插件

下面将详细介绍如何通过 Coze 的 IDE 创建一个自定义插件。

> 制作谷歌搜索插件为例，如果想学习零代码从0到1插件谷歌插件（AI 编程），跳转：[【Coze插件】零代码创建谷歌插件](https://zxdwhda-share.feishu.cn/wiki/Z4YGw0fSSinTn6kX6jlcP6uunje?fromScene=spaceOverview)

#### 前期准备

> 参考：https://zhuanlan.zhihu.com/p/174666017

官方需要非大陆链接，而且需要外币卡，所以我们使用这里使用 `serper` ：https://serper.dev/

- 有免费的额度，可以调用2500次

- 国内直连

这里不多演示注册，复制key，后面需要

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/45190712-bf6f-4497-b76b-428175495fe7.png
```

#### 新建插件资源与工具

> 下面教程内容是 3 月份截屏部分布局有小变动，未更新请谅解

登录 Coze 平台，进入 "资源库" 页面

点击 "资源"，选择 "插件"

插件配置

- **插件名称** ： `谷歌搜索` 

- **插件描述** ： `搜索网页` 

- **插件工具创建方式** ： `云侧插件 - 在 Coze IDE 中创建` 

- **IDE 运行时** ： `Node.js` 

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/7bdbf6b1-31d4-43b1-8a0c-06b972509c1c.png
```

让我们创建一个工具，点击“在IDE中创建工具”

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/ff6cf9f8-85a1-42c7-9851-f5f1a44cac35.png
```

点击左上角的“创建工具”

- 名称：Google_Search_Express

- 描述：谷歌搜索快速版

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/91eaa731-9cd3-49b5-9a43-061dca60ca40.png
```

```{lark-callout}
:bg: light-orange
:bc: orange
:icon: grinning

## 好的，老规矩，先看布局（其实是知识点讲解，跳过可点击：[第 4 章 资源的玩法](https://zxdwhda-share.feishu.cn/wiki/M7towKWKhiLMxWkTCincqhDAnjc?fromScene=spaceOverview#OnOhdBNb7oFtQVxlhFucTheGno5)）
```

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/f1ee4177-cfad-4937-8226-4f0e88c6a69a.png
```

让我们逐条分析

1. 这里是工具列表，我们刚才新建了一个 `Google_Search_Express` ，所以不是空置，有同学要问了，这里对应商店的是哪里，让我们以 `飞书云文档` 为例

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/1fd795b4-56ee-4d9b-972c-c74b579d4da0.png
```

大家可以发现，插件是有好几个工具的，还记得前面说的“插件是一个工具集，一个插件内可以包含一个或多个工具（API）。”，我们刚才创建的插件是有一个工具（当然也可以有多个），而 `飞书云文档` 有多个。

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/8e41061a-daaa-4760-9254-d1da75d95299.png
```

2. 依赖包

> **依赖包** 区域，管理依赖包，所有工具共用该依赖列表。
> 
> 单击 **+** 或者单击 **添加依赖** 按钮，输入依赖包名称并选择版本（可通过依赖名@版本号的格式进行搜索），然后安装依赖包。

在编程中，依赖包（也称为库、模块或包）是预先编写好的代码集合，用于解决特定的问题或提供特定的功能。是可复用的代码集合，提供特定功能（如数据处理、网络请求、UI组件等）。开发者通过导入这些包来避免重复造轮子，提升开发效率。

3. 代码

> 不同 IDE 运行时的代码模板不同，这里是Node.js的代码模板。

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/51e900f9-b73c-4100-a0eb-1b66f5f39cc5.png
```

这里是你写或者让AI编写代码的地方。

4. 元数据

元数据的作用是让大语言模型理解每个工具输入或输出参数有哪些、各个参数有何含义。因此，在工具的元数据内提供详细的参数说明，可以让大语言模型更准确的使用工具。

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/6e185cf2-d9a5-41e2-a16c-0da5342b20cb.png
```

当用户在使用该工具的智能体时，模型会根据工具的元数据信息，从用户问答中解析、提取出对应的输入参数，并选择调用该工具，流程图如下所示。

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/fa895e9d-f806-48be-8dde-8feebe9907e2.png
```

元数据配置说明：

````{lark-table}
:size: 6,2
:width: 100,804

```{lark-table-cell}
:pos: 1,1

配置项
```

```{lark-table-cell}
:pos: 1,2

描述
```

```{lark-table-cell}
:pos: 2,1

名称
```

```{lark-table-cell}
:pos: 2,2

工具名称。建议输入清晰易理解的名称，便于后续大语言模型搜索与使用工具。
```

```{lark-table-cell}
:pos: 3,1

描述
```

```{lark-table-cell}
:pos: 3,2

工具的描述信息，一般用于记录当前工具的用途。
```

```{lark-table-cell}
:pos: 4,1

启用
```

```{lark-table-cell}
:pos: 4,2

是否启用当前工具。使用说明：
- 如果工具未开发测试完成，建议先禁用该工具，只启用并发布已通过测试的工具。
- 如果需要下线某一工具，可将该工具设置为禁用，并再次发布插件。- 如果插件中只有一个工具，则不支持禁用该工具。如需下线该工具，您可以选择直接删除该插件，或者创建另一个工具并完成开发测试后，再禁用该工具，最后发布插件。
```

```{lark-table-cell}
:pos: 5,1

输入参数
```

```{lark-table-cell}
:pos: 5,2

当前工具对应接口的输入参数信息。准确、清晰易理解的参数名称、描述等信息，可以让大语言模型更准确的使用工具。
```

```{lark-table-cell}
:pos: 6,1

输出参数
```

```{lark-table-cell}
:pos: 6,2

当前工具对应接口的输出参数信息。准确、清晰易理解的参数名称、描述等信息，可以让大语言模型更准确的使用工具。
```
````

5. 测试相关

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/0ee14e76-4e0b-4af0-9cc9-a4168759475c.png
```

让我们先看测试代码，分别有输入、输出；一般我们做测试的时候只需要写输入就可以使用了，输出后面可以让Coze一键生成。而控制台是我们查看运行日志。

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/ecda25db-9962-45b7-80f4-b0a9859bfd8b.png
```

这是日志，日志一般只保留7天

```{lark-callout}
:bg: light-orange
:bc: orange
:icon: +1

## 好了！通过刚才的学习，相信你一定对插件与工具之间的作用有了一定的了解，下面让我们开始实操。
```

#### 完善工具

安装依赖包，搜索“ `axios` ”

`````{lark-grid}
:width: 70,29

````{lark-grid-column}
```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/68c23a25-2fde-47f5-b080-57553cd1c384.png
```
````

````{lark-grid-column}
```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/b6b24de4-5bf7-4ea7-bb11-c2ca3102262a.png
```
````
`````

复制代码粘贴

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/783b843a-68bc-4d86-a3e2-2e7fe4ae331c.png
```

```typescript
import { Args } from '@/runtime';
import axios from 'axios';

interface Input {
  q: string;     // 必填：搜索关键词
  key: string;   // 必填：API密钥
}

interface SearchResult {
  title: string;
  link: string;
  snippet: string;
}

interface Output {
  success: boolean;
  error?: string;
  results: SearchResult[];
  related?: string[];
}

export async function handler({ input, logger }: Args<Input>): Promise<Output> {
  // 基本参数验证
  if (!input.q || !input.key) {
    const errorMsg = 'Missing required parameters: both "q" and "key" are required';
    logger.error(errorMsg);
    return {
      success: false,
      error: errorMsg,
      results: []
    };
  }

  try {
    const { data } = await axios({
      method: 'post',
      url: 'https://google.serper.dev/search',
      headers: { 
        'X-API-KEY': input.key, // 使用动态API密钥
        'Content-Type': 'application/json'
      },
      data: JSON.stringify({
        q: input.q,
        gl: 'us',       // 默认国家：美国
        hl: 'en',       // 默认语言：英语
        num: 10,        // 默认结果数：10
        page: 1,        // 默认页码：1
        location: '',   // 默认地点：空
        tbs: ''         // 默认日期范围：空
      }),
      timeout: 10000
    });

    logger.info(`Successfully fetched ${data.organic?.length || 0} results for "${input.q}"`);
    
    // 结果格式化
    const results: SearchResult[] = data.organic?.map((item: any) => ({
      title: item.title,
      link: item.link,
      snippet: item.snippet
    })) || [];

    return { 
      success: true,
      results,
      related: data.related?.map((r: any) => r.query) || []
    };

  } catch (error: any) {
    // 精简错误信息提取
    const errorMsg = error.response?.data?.message || error.message || 'Unknown search error';
    logger.error(`Search failed for "${input.q}": ${errorMsg}`);
    
    return {
      success: false,
      error: errorMsg,
      results: []
    };
  }
};
```

编辑输入参数

- 名称 `q` 
  
  - *搜索关键词*
  
- 描述 `Key` 
  
  - *API密钥*
  
```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/d417d624-2888-4177-966e-fed6fc22fcb6.png
```

实操不好的小伙伴，看视频：

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/89678458-1dfc-45b5-9c9f-3414b2dbbe3a.png
```

#### 测试

点击右上角“自动生成”

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/b7a95504-a265-4c8e-9d20-cc391ab57eed.png
```

修改默认的内容，点击运行，然后替换真实值

`````{lark-grid}
:width: 48,51

````{lark-grid-column}
```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/6fecf211-92b2-4804-a090-ca6359200539.png
```
````

````{lark-grid-column}
```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/5f2387fc-e5a4-4f8e-bade-e2339dd04e77.png
```
````
`````

可以看到运行结果

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/7a725777-9b81-4aff-a3fe-cf2d5e24d625.png
```

点击“更新输出参数”

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/00ef6001-d43a-4e7e-90fd-3efdee74d9ac.png
```

出现这个说明正常，有的时候会卡

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/815bd541-139e-451c-9ac6-2ef7ec20605c.png
```

我们可以看到输出参数给我们写好了

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/41cf4e21-594a-41a3-9b0d-cbef566d7a39.png
```

#### 发布

点击发布，稍等

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/e4e46fbc-0a1f-430b-9314-63fe0d4017d3.png
```

返回到智能体就可以看到了~

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/eb0a7c92-105d-4f1d-bf27-0dd94ee9dfa1.png
```

```{lark-callout}
:bg: light-orange
:bc: orange
:icon: +1

好了，我把最难的放在了前面，后面的就简单了很多，加油！
```

### 通过 JSON 或 YAML 文件导入插件

> 制作gpt-4o插件为例
> 
> 参考：https://help.302.ai/docs/ji-cheng-dao-Coze-guo-nei-ban?search=1
> 
> 下面教程内容是 3 月份截屏部分布局有小变动，未更新请谅解

这个工具使用较少，建议跳过

#### 前期准备

这里使用的302.AI，使用原因：是题目的文档中的 YAML 文件使用比较详细，而且新人有免费额度，不做其他推荐使用，请自行寻找中转接口。

让我们注册：https://302.ai/

打开后台，添加API，复制，后面有用

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/b91e310e-076b-4920-89a6-4d31608b97b3.png
```

#### 新建插件资源与工具

先让我们创建一个插件，点击导入

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/0561efbc-c84a-4c05-aa74-adddaea3dc81.png
```

点击“URL和原始数据”，复制粘贴下面内容

```yaml
info:
    description: 302_AI
    title: 302_AI
    version: v1
openapi: 3.0.1
paths:
    /v1/chat/completions:
        post:
            operationId: Chat
            parameters:
                - description: 302.AI管理后台-API超市-API管理，复制生成的API Key
                  in: header
                  name: Authorization
                  required: true
                  schema:
                    default: sk-xxx
                    type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            properties:
                                message:
                                    default: Hello
                                    description: 发给LLM的消息
                                    type: string
                                model:
                                    default: gpt-4o
                                    description: LLM的模型名
                                    type: string
                            required:
                                - message
                                - model
                            type: object
            responses:
                "200":
                    content:
                        application/json:
                            schema:
                                properties:
                                    output:
                                        description: LLM的输出
                                        type: string
                                type: object
                    description: new desc
                default:
                    description: ""
            summary: |-
                和各个llm进行单轮对话。模型列表请查看302.AI官网API文档，国内国外开源模型全部支持。
                仅需要输入model和message，即可获得output，是最简单的调用各种大模型的插件。
                非常适合用在各种对文本能力要求高的工作流中，当作单纯的输入和输出流程使用。
servers:
    - url: https://api.302.ai/v1/chat/completions

```

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/e27f7018-e0dd-49de-afc0-1139e02283d1.png
```

导入插件——下一步——确认

`````{lark-grid}
:width: 48,51

````{lark-grid-column}
```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/351eea39-6cc3-4259-aae0-7387e3ef051d.png
```
````

````{lark-grid-column}
```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/650c1e98-894a-4b8b-93ec-0eca5046803d.png
```
````
`````

开启“启用”

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/12688ad0-4b80-401c-950f-3bf3f48f501f.png
```

点击调试

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/ac2391aa-d048-48a1-8234-25a4d635c27a.png
```

点击“试运行”

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/c53f840b-1d48-48f7-b007-f80abf6c77a2.png
```

点击运行（{bg:#f76964}`注意填写密钥`）

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/c80a558f-4470-47bc-9c74-e93782c6e9f3.png
```

运行成功

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/a7845125-26a3-4a0f-9b43-d7a2d1439d90.png
```

#### 发布

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/6611746c-4893-4f8d-81c4-4c27cc0d7ce1.png
```

## 知识库

> 本小节基于扣子知识库，不含“火山知识库”相关知识

### 知识库概述

大模型由于其工作原理，虽然可以回答通用的问题，但在专业技术的垂直领域中，模型知识的技术深度、更新及时性和准确性非常有限。如果对于模型生成的文本准确性要求较高，例如企业智能客服、高精尖科学技术服务等应用场景，往往需要通过知识库集成私有的知识数据，丰富 AI 应用的知识范围、提高模型回复的可靠性。

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/133dda1d-0571-499c-a84e-334c81d54353.png
```

#### 知识库的核心功能

1. **数据管理与存储** 

Coze 支持从多种数据源上传文本和表格数据：​

- 本地文档（PDF、Word、Excel、TXT 等）

- 在线数据（网页链接、API 接口）

- 第三方平台（Notion、飞书文档等）

上传后，Coze 会将知识内容自动切分为内容片段进行存储，同时支持用户自定义内容分片规则。

2. **增强检索** 

Coze 的知识库提供了多种检索方式：​

- 全文检索：通过关键词进行内容片段检索和召回

- 语义检索：基于向量相似度的智能检索

- 结构化检索：针对表格数据的精确查询

3. **知识增强生成** 

大语言模型会根据召回的内容片段生成最终的回复内容，确保回答的准确性和相关性。

#### 知识与记忆对比

````{lark-table}
:size: 5,3
:width: 200,200,200

```{lark-table-cell}
:pos: 1,1

特性
```

```{lark-table-cell}
:pos: 1,2

知识库
```

```{lark-table-cell}
:pos: 1,3

记忆功能
```

```{lark-table-cell}
:pos: 2,1

数据性质
```

```{lark-table-cell}
:pos: 2,2

静态数据
```

```{lark-table-cell}
:pos: 2,3

动态数据
```

```{lark-table-cell}
:pos: 3,1

访问权限
```

```{lark-table-cell}
:pos: 3,2

开发者管理，可共享
```

```{lark-table-cell}
:pos: 3,3

用户私有，不可共享
```

```{lark-table-cell}
:pos: 4,1

使用场景
```

```{lark-table-cell}
:pos: 4,2

专业知识、企业数据
```

```{lark-table-cell}
:pos: 4,3

用户偏好、会话历史
```

```{lark-table-cell}
:pos: 5,1

更新方式
```

```{lark-table-cell}
:pos: 5,2

手动更新
```

```{lark-table-cell}
:pos: 5,3

自动学习
```
````

以租房平台智能体为例：​

- **知识库** ：房源信息、 rental 政策、城市介绍等

- **记忆功能** ：用户浏览历史、收藏列表、搜索偏好等

下表展示了哪些数据是需要通过知识功能来维护的，哪些数据是通过记忆功能来维护的。

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/d859e92d-6445-41a4-92b5-119819c8cd11.png
```

### 知识库类型

#### 文本知识库

 **特点** ：

- 支持基于内容片段的检索和召回

- 适用于知识问答、文档理解等场景

- 支持多种文本格式：PDF、Word、TXT、网页等

 **应用场景** ：

- 企业知识库

- 产品手册

- 技术文档

- 法律法规

#### 表格知识库

 **特点** ：

- 支持基于索引列的匹配

- 支持 NL2SQL 查询和计算

- 适用于数据查询、统计分析等场景

 **应用场景** ：

- 产品价格表

- 库存管理

- 销售数据

- 财务报表

#### 图片知识库

 **特点** ：

- 支持基于标注信息的匹配

- 适用于图像生成、视觉搜索等场景

- 支持自动图像标注

 **应用场景** ：

- 商品图片库

- 设计素材

- 产品展示

- 场景推荐

### 知识库创建与使用



1. **文本** 

这里使用我们前 3 章节的教程作为知识库：






2. **照片** 

这里使用之前工作流教程的图片集作为演示（下载后记得解压


#### 创建文本知识库

进入 Coze 平台，打开到我们的资源库页面

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/dd7136f9-1d34-4e58-8697-9aa653734a00.png
```

点击“资源”，选择“知识库”

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/e738fa18-494d-4c07-877d-6e0b023942d1.png
```

选择知识库类型："文本知识库"

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/a9977f1c-54d9-4a28-a15d-da9ed2314f7a.png
```

我们先做一份文本知识库“Agent”，导入类型选择“本地文档”，然后选择“创建并导入”

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/5c31599e-de9c-4e02-adc8-1663bb82aa4d.png
```

在这个页面，点击：“上传”，把我们刚才的下载的 PDF上传上去

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/16d11fcf-7a90-4d0e-865f-f0a2a26dfd1e.png
```

正在上传中，上传完毕后点击“下一步”

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/1814999f-0568-47c2-8c8c-b60e12518017.png
```

默认配置，点击“下一步”

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/70696207-184c-4c87-af54-ba707a8718fe.png
```

继续下一步

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/1822f411-1536-403e-be4f-dfeefbd65582.png
```

这里我们点击“确认”

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/3761fd75-5c5f-4aad-adf2-1b583351173c.png
```

因为切块处理，需要一段时间，我们先跳过，去创建“图片”知识库

#### 创建图片知识库

同样打开资源库，点击右上角的资源，然后选择知识库

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/e05e660f-4704-4ae7-b035-fc99af8055e1.png
```

和前面一样，我们选择“创建扣子知识库”

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/103d9579-3c10-4576-ba7d-66c6e29b35f5.png
```

创建“御坂美琴”图片知识库，默认选项，然后“创建并导入”

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/0486f149-c6e5-43bb-a04d-831d17b07881.png
```

上传我们刚才下载解压的图片压缩包的文件

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/d6a08f22-87ff-4baa-b89b-b72cac33fef9.png
```

等待上传完毕后，点击“下一步”

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/60f8a35b-6056-4bcf-8401-8563349a0007.png
```

这里选择智能标注，点击“下一步”

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/4a080cc8-516a-4653-b7b1-217ecedac7a8.png
```

等待处理

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/174b8f72-bfa3-4817-a09b-ec3f0109b118.png
```

### 实操-体验知识库

创建一个新的智能体

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/a2a83e77-2c63-49e5-8267-c70fb338febd.png
```

先让智能体不调用知识库回答，我们可以发现模型的回答的还行，在介绍 AI 工作流的时候出现了错误，“数据处理、模型训练、模型评估、部署”每一个都可以是新的内容，和 AI工作流的差距很大

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/7ff5da7b-9dcc-4be0-8dbe-6c9991b85813.png
```





点击“+”，添加知识库

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/728ef529-79d7-4815-9218-f158afc7b7c6.png
```

添加我们刚才创建的“Agent”知识库

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/3f3e229b-434f-43f0-a000-af66c02bb01b.png
```

我们询问相同的问题，模型调用了知识库，我们发现和我们前两天学习的内容是一样的，这里其实就是一个课程助手，可以作为一个案例展开聊了

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/449d87cf-a30b-4e96-ba9c-771e66edfbe7.png
```

知识库的基本概念和操作步骤，我们也学会了，就不多说了，主要内容是 Coze 的特色“图片知识库”

下面让我们一起实操一下，删除文本知识库、删除对话记录，点击“+”，添加图片知识库

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/560eb7c2-83ba-4dc8-89d8-1c0824e85854.png
```

选择我们刚才上传的图片知识库

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/7273f419-21bf-48f4-ac5a-b0e1e798b8d7.png
```

我们简单测试了一下，可以看到，因为图片知识库中没有说图片主角是“炮姐”，模型说没有找到，但是给我们推白色衣服的；这个“炮姐”关键词可以自定义放到图片知识库中

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/d10fd806-3361-4ac0-9308-e7ebeee32ea9.png
```

## 提示词

> 提示词的内容整体繁杂，建议小白认真学习，了解理论知识即可

### 什么是提示词？

提示词（Prompt）是一种自然语言指令，它为大语言模型（LLM）提供任务指导。搭建智能体的第一步就是设置提示词，你可以根据业务需要直接编写提示词，也可以使用提示词模板、引用提示词资源或通过 AI 自动生成提示词。

简单来说，提示词就是给 AI 的 "任务说明书"，它决定了 AI 如何理解用户需求并生成相应的回答。

在 Coze 中分为两种：

- **系统提示词** ：给 AI 定 "人设"，全程影响 AI 的回复风格

- **用户提示词** ：具体需求，比如 "推荐 3 款适合黄皮的平价口红，带价格"

#### 提示词的分类

> 当然下面内容不一定，用户提示词也可以放到系统提示词中，反之依然

 **系统提示词** 

- 定义 AI 的角色和身份

- 设定回答的风格和语气

- 建立基本的行为准则

- 全程影响 AI 的响应模式

 **用户提示词** 

- 具体的任务指令

- 问题描述

- 输出格式要求

- 临时的行为调整

### 提示词的核心组成要素

一个完整的提示词通常包含以下几个核心部分：

#### 角色设定（Role）

明确 AI 应该扮演的角色和身份，包括：​

- 专业背景

- 技能特长

- 经验水平

- 性格特点

 **示例** ：

```
你是一位资深的软件架构师，拥有10年以上的分布式系统设计经验，擅长微服务架构、云原生技术和高性能计算。你曾经参与过多个大型互联网项目的架构设计，对系统性能优化和安全防护有深入的理解。
```

#### 任务描述（Task）

清晰定义 AI 需要完成的具体任务：​

- 任务目标

- 输入输出要求

- 质量标准

- 时间限制

 **示例** ：

```
请设计一个高并发的电商订单系统架构，支持每秒10万笔订单的处理能力。系统需要具备高可用性、数据一致性和可扩展性。请详细说明系统的整体架构、核心组件、技术选型和关键设计决策。
```

#### 技能说明（Skills）

列出 AI 应该具备的能力和可以使用的工具：​

- 专业技能

- 工具使用能力

- 知识范围

- 问题解决能力

 **示例** ：

```
## 核心技能
- 系统架构设计：微服务架构、DDD领域驱动设计、事件驱动架构
- 技术选型：Java/Spring Cloud、Go、Docker/Kubernetes、Redis、MySQL
- 性能优化：缓存策略、数据库优化、异步处理、负载均衡
- 安全设计：身份认证、权限管理、数据加密、API安全
```

#### 工作流程（Workflow）

说明完成任务的步骤和逻辑：​

- 思考过程

- 执行步骤

- 决策逻辑

- 验证方法

 **示例** ：

```markdown
## 设计流程
1. **需求分析**：深入理解业务需求和技术约束
2. **架构设计**：
   - 确定系统边界和核心功能模块
   - 设计整体架构图和技术栈
   - 制定数据模型和接口规范
3. **详细设计**：
   - 核心组件的详细设计
   - 关键算法和业务逻辑
   - 异常处理和容错机制
4. **性能优化**：
   - 识别性能瓶颈
   - 制定优化策略
   - 设计监控和告警机制
5. **安全设计**：
   - 安全威胁分析
   - 安全防护措施
   - 合规性考虑
```

#### 输出格式（Format）

规定回答的格式和结构：​

- 内容组织方式

- 格式要求

- 可视化元素

- 交互方式

 **示例** ：

```markdown
## 输出格式要求
请按照以下结构组织你的回答：
### 1. 架构概述
- 系统整体架构图（文字描述）
- 核心技术栈
- 系统特性总结
### 2. 核心组件设计
- 组件名称和职责
- 技术实现方案
- 关键接口定义
### 3. 数据设计
- 数据库选型和设计
- 缓存策略
- 数据一致性保障
### 4. 性能优化
- 性能目标
- 优化策略
- 监控指标
### 5. 安全设计
- 安全架构
- 防护措施
- 合规要求
### 6. 部署运维
- 部署架构
- 运维策略
- 灾备方案
```

#### 约束条件（Constraints）

明确 AI 的行为边界和限制：​

- 禁止内容

- 质量要求

- 伦理准则

- 合规要求

 **示例** ：

```
## 约束条件
- 设计必须符合行业最佳实践和安全标准
- 避免使用过于复杂或不成熟的技术
- 确保系统的可维护性和可扩展性
- 考虑成本效益和团队技术栈匹配度
- 不涉及任何违法违规内容
```

### 提示词编写的最佳实践

> 混杂了几个大模型平台的最佳实践，由 AI 编写整合

#### 清晰明确的指令

 **原则** ：使用具体、明确的语言，避免模糊和歧义。

 **错误示例** ：

```
帮我设计一个网站。
```

 **正确示例** ：

```
请设计一个电子商务网站，主要销售电子产品。网站需要包含以下功能：
- 用户注册和登录
- 商品展示和搜索
- 购物车和结算
- 订单管理
- 支付集成
- 用户评价系统
技术栈要求：
- 前端：React + TypeScript
- 后端：Node.js + Express
- 数据库：MongoDB
- 部署：Docker + AWS
```

#### 结构化的表达方式

 **原则** ：使用 markdown 格式，合理使用标题、列表、表格等元素。

 **示例** ：

```
# 产品需求文档
## 1. 产品概述
- **产品名称**：智能健康管理APP
- **目标用户**：25-45岁关注健康的都市人群
- **核心价值**：通过AI技术提供个性化的健康管理方案
## 2. 核心功能
### 2.1 健康数据采集
- 步数统计
- 睡眠监测
- 心率监测
- 饮食记录
### 2.2 AI健康分析
- 健康风险评估
- 个性化建议
- 趋势分析
- 预警提醒
## 3. 用户界面要求
- 简洁现代的设计风格
- 响应式布局
- 支持暗黑模式
- 无障碍设计
```

#### 提供示例和上下文

 **原则** ：通过具体示例帮助 AI 理解期望的输出格式。

 **示例** ：

```
请按照以下格式生成产品用户故事：
## 用户故事格式
**作为** [用户角色]
**我希望** [功能描述]
**以便** [业务价值]
**验收标准**：
- [具体的验收条件1]
- [具体的验收条件2]
- [具体的验收条件3]
## 示例
**作为** 普通用户
**我希望** 能够通过手机号快速注册账号
**以便** 快速开始使用产品功能
**验收标准**：
- 支持中国大陆手机号格式验证
- 发送验证码短信，有效期5分钟
- 密码强度检测（至少8位，包含字母和数字）
- 注册成功后自动登录
## 请为以下功能生成用户故事
功能：商品收藏功能
```

#### 迭代优化的思路

 **原则** ：通过多次交互不断优化提示词和输出结果。

 **优化流程** ：

1. **初始提示** ：基于初步需求编写提示词

2. **测试验证** ：运行提示词并查看结果

3. **分析反馈** ：评估结果是否符合预期

4. **调整优化** ：修改提示词并再次测试

5. **固化模板** ：将优化后的提示词保存为模板

 **示例优化过程** ：

 **第一次提示** ：

```
写一篇关于AI发展趋势的文章。
```

 **第一次结果分析** ：

内容过于宽泛，缺乏深度和结构。

 **第二次提示** ：

```
请写一篇关于2025年AI发展趋势的分析文章，重点关注以下几个方面：
1. 大语言模型的发展方向
2. AI在企业中的应用场景
3. AI伦理和监管发展
4. 对就业市场的影响
要求：
- 文章结构清晰，有引言、正文和结论
- 每个趋势点要有具体的数据或案例支持
- 语言专业但不晦涩
- 字数控制在1500字左右
```

 **第二次结果分析** ：

结构有所改善，但案例不够具体，数据支持不足。

 **第三次提示** ：

```
请写一篇关于2025年AI发展趋势的专业分析报告，按照以下结构组织：
# 2025年AI发展趋势报告
## 1. 引言
- AI发展现状概述
- 2025年发展背景
## 2. 核心趋势分析
### 2.1 大语言模型的进化
- 模型规模和能力提升（具体数据）
- 多模态能力的融合
- 模型效率优化技术
- 案例：GPT-5、Claude 3等最新模型的突破
### 2.2 企业AI应用深化
- 行业渗透率数据
- 典型应用场景分析
- ROI数据和成功案例
- 中小企业AI采用趋势
### 2.3 监管框架完善
- 主要国家和地区的监管政策
- 伦理准则的建立
- 合规技术的发展
- 对企业的影响分析
### 2.4 就业市场变革
- 就业结构变化数据
- 新兴职业和消失职业
- 技能需求变化
- 教育和培训趋势
## 3. 挑战与风险
- 技术挑战
- 伦理风险
- 安全威胁
- 社会影响
## 4. 结论与建议
- 发展前景展望
- 对企业的建议
- 对个人的建议
要求：
- 每个部分都要有权威数据支持（注明来源）
- 提供具体的案例分析
- 使用专业的分析框架
- 保持客观中立的立场
- 总字数2000-2500字
```

### 提示词调试与优化工具

Coze 平台提供了强大的提示词调试和优化工具，帮助用户提升提示词质量。

#### 提示词对比调试

提示词对比调试功能支持输入两版提示词，对比大模型回复效果的差异。

 **使用步骤** ：

1. 在智能体编排页面，点击 "提示词对比调试"

2. 在 "默认提示词" 和 "对比提示词" 区域输入两版提示词

3. 选择一个大模型进行测试

4. 查看两版提示词的回复结果差异

5. 基于结果选择更优的提示词

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/f5d63adc-d4c1-4a97-8c6b-66d3f772961c.png
```

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/c4d4abf6-d7af-414c-951b-3c669526b6e0.png
```

#### 模型对比调试

模型对比调试功能支持基于同一提示词，对比不同模型或同模型不同配置下的回复结果差异。

 **使用步骤** ：

1. 在模型选择框中，点击 "模型对比调试"

2. 输入提示词或从提示词库中选择

3. 选择两个大模型或不同配置的大模型

4. 查看不同模型的回复结果差异

5. 选择最适合的模型配置

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/0655a372-aa45-431e-af88-078e6eee16eb.png
```

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/60d6d7b5-557f-4a5d-b84e-567227c0c7cc.png
```

#### AI 辅助提示词生成

Coze 提供 AI 辅助提示词生成功能，可以帮助用户快速创建高质量的提示词。

 **使用方法** ：

1. 在提示词编辑页面，点击 "AI 生成"

2. 输入对提示词的需求描述

3. 点击 "生成" 按钮

```{img}
:caption: 
:frac: 100%

https://datawhale-business.oss-cn-hangzhou.aliyuncs.com/image/67302a89-2d5a-4d83-8123-82f4edebe0cb.png
```

### 高级提示词技巧

#### 链式提示词

链式提示词是指将复杂任务分解为多个简单的子任务，通过多轮对话逐步完成。

 **示例** ：

```
# 第一轮：需求分析
我需要设计一个移动APP，请先分析我的需求。
# 第二轮：用户调研
基于需求分析，帮我设计用户调研方案。
# 第三轮：功能设计
根据调研结果，设计APP的核心功能模块。
# 第四轮：界面设计
基于功能设计，创建APP的界面设计方案。
# 第五轮：技术选型
根据设计方案，推荐合适的技术栈。
```

#### 条件分支提示词

条件分支提示词允许根据不同的条件执行不同的操作流程。

 **示例** ：

```markdown
根据用户的问题类型，选择相应的处理流程：
## 如果是技术问题：
1. 分析问题的技术领域
2. 提供详细的技术解决方案
3. 包含代码示例和配置说明
4. 给出测试和验证方法
## 如果是业务问题：
1. 理解业务背景和目标
2. 分析问题的根本原因
3. 提供多种解决方案
4. 评估各方案的优缺点
5. 给出推荐建议
## 如果是概念问题：
1. 提供清晰的概念定义
2. 解释相关的理论基础
3. 给出实际应用案例
4. 比较相关概念的异同
## 如果问题不明确：
1. 通过提问澄清需求
2. 引导用户提供更多信息
3. 提供几个可能的理解方向
4. 请用户确认正确的理解
```

#### 动态提示词生成

> 一般在工作流中使用

动态提示词生成是指根据上下文信息动态调整提示词内容。

 **示例** ：

```
# 动态提示词生成器
## 分析当前对话状态
- 用户问题类型：{{question_type}}
- 用户历史对话：{{history}}
- 当前任务：{{current_task}}
- 已完成步骤：{{completed_steps}}
- 待完成步骤：{{pending_steps}}
## 动态生成提示词
基于以上信息，生成最适合当前状态的提示词：
{{dynamic_prompt}}
```